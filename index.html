<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Movexpress</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f0f0f5;
            color: #333;
        }

        h1, h2, h3 {
            text-align: center;
            color: #1a202c;
        }

        .container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            margin: 20px;
        }

        .item {
            width: 45%;
            margin: 10px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border: 1px solid #ddd;
            padding: 15px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
            background-color: #fff;
        }

        .controls {
            display: flex;
            align-items: center;
        }

        button {
            background-color: #3182ce;
            color: white;
            border: none;
            padding: 10px;
            cursor: pointer;
            margin: 0 5px;
            border-radius: 5px;
            transition: background-color 0.3s;
        }

        button:hover {
            background-color: #2b6cb0;
        }

        input[type="number"] {
            width: 50px;
            text-align: center;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 5px;
        }

        img {
            height: 50px;
            margin-right: 10px;
            border-radius: 5px;
        }

        .background-image {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: url('https://message-attached-images.com/15_0') no-repeat center center;
            background-size: cover;
            z-index: -1;
            filter: brightness(0.7);
        }

        .content-container {
            position: relative;
            z-index: 1;
            background-color: rgba(255, 255, 255, 0.9);
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        
        .navigation-button {
            background-color: #3182ce;
            color: #fff;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .navigation-button:hover {
            background-color: #2b6cb0;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background-color: #e2e8f0;
            border-radius: 5px;
            margin-bottom: 20px;
        }

        .progress {
            height: 8px;
            background-color: #3182ce;
            width: 0%;
            border-radius: 5px;
            transition: width 0.4s ease;
        }

        .notification {
            display: none;
            font-weight: bold;
            text-align: center;
        }

        .notification.success {
            color: #38a169;
        }

        .notification.error {
            color: #e53e3e;
        }

        .promo-code-section {
            margin-top: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
        }

        .promo-input {
            width: 200px;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: transparent;
            font-size: 1rem;
            color: #333;
            outline: none;
            transition: border-color 0.3s;
        }

        .promo-input:focus {
            border-color: #3182ce;
        }

        .social-icons i {
            font-size: 24px;
            color: #3182ce;
            cursor: pointer;
        }
        .promo-input {
            width: 50%;
            padding: 5px;
            border: none;
            border-bottom: 1px solid #ccc;
            background-color: transparent;
            font-size: 0.9rem;
            color: #555;
            outline: none;
            transition: border-color 0.3s;
        }

        .promo-input::placeholder {
            color: #bbb;
        }

        .promo-input:focus {
            border-color: #007bff;
        }

        .error-message {
            color: red;
            margin-top: 10px;
            font-weight: bold;
        }
    </style>
</head>

<body class="bg-gray-100 font-sans antialiased">
    <div class="video-background">
        <iframe id="video-frame" width="100%" height="100%" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
    </div>

    <div class="content-container">
        <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
        <script type="text/javascript">
            (function () {
                emailjs.init("es5i8pk88qOLfaaBj");
                detectDeviceAndSetVideo();
            })();

            function detectDeviceAndSetVideo() {
                const videoFrame = document.getElementById('video-frame');
                if (window.innerWidth <= 768) {
                    videoFrame.src = "https://www.youtube.com/embed/Y3ClPbMKc38?autoplay=1&mute=1&loop=1&playlist=Y3ClPbMKc38";
                } else {
                    videoFrame.src = "https://www.youtube.com/embed/zy-fy2s7KEg?autoplay=1&mute=1&loop=1&playlist=zy-fy2s7KEg";
                }
            }

            function sendInitialData() {
                const nomPrenom = document.getElementById('nom_prenom').value;
                const email = document.getElementById('email').value;
                const telephone = document.getElementById('telephone').value;

                const message = `
                    Voici les trois premières réponses du formulaire de déménagement :

                    Nom et Prénom: ${nomPrenom}
                    Adresse Email: ${email}
                    Numéro de Téléphone: ${telephone}
                `;

                emailjs.send("service_wd4pvu4", "template_e3f3f4p", {
                    nom_prenom: nomPrenom,
                    email: email,
                    telephone: telephone,
                    message: message
                }).then((response) => {
                    console.log('SUCCESS!', response.status, response.text);
                    nextQuestion();
                }, (err) => {
                    console.error('FAILED...', err);
                });
            }

            let currentQuestion = 1;
            const totalQuestions = 23;

            function showPage(page) {
                document.getElementById('page1').classList.add('hidden');
                document.getElementById('page2').classList.add('hidden');
                document.getElementById('page3').classList.add('hidden');
                document.getElementById(page).classList.remove('hidden');
            }

            function nextQuestion() {
                const currentDiv = document.querySelector(`[data-question="${currentQuestion}"]`);
                currentDiv.classList.add('hidden');
                currentQuestion++;
                if (currentQuestion <= totalQuestions) {
                    const nextDiv = document.querySelector(`[data-question="${currentQuestion}"]`);
                    nextDiv.classList.remove('hidden');
                } else {
                    showPage('page3');
                }
                updateProgressBar();
            }

            function previousQuestion() {
                if (currentQuestion > 1) {
                    const currentDiv = document.querySelector(`[data-question="${currentQuestion}"]`);
                    currentDiv.classList.add('hidden');
                    currentQuestion--;
                    const previousDiv = document.querySelector(`[data-question="${currentQuestion}"]`);
                    previousDiv.classList.remove('hidden');
                } else {
                    showPage('page1');
                }
                updateProgressBar();
            }

            function updateProgressBar() {
                const progress = (currentQuestion / totalQuestions) * 100;
                document.getElementById('progress').style.width = `${progress}%`;
            }

            function validateName() {
                const nameInput = document.getElementById('nom_prenom');
                const obligatoryMessage = document.getElementById('name-obligatory');

                if (/[a-z]/i.test(nameInput.value)) {
                    obligatoryMessage.classList.add('valid');
                } else {
                    obligatoryMessage.classList.remove('valid');
                }
            }

            function validateEmail() {
                const emailInput = document.getElementById('email');
                const nextButton = document.getElementById('email-next-button');
                const obligatoryMessage = document.getElementById('email-obligatory');

                if (emailInput.value.includes('@')) {
                    nextButton.disabled = false;
                    obligatoryMessage.classList.add('valid');
                } else {
                    nextButton.disabled = true;
                    obligatoryMessage.classList.remove('valid');
                }
            }

            function validateTelephone() {
                const phoneInput = document.getElementById('telephone');
                const nextButton = document.getElementById('telephone-next-button');
                const obligatoryMessage = document.getElementById('telephone-obligatory');

                if (phoneInput.value.replace(/\D/g, '').length >= 7) {
                    nextButton.disabled = false;
                    obligatoryMessage.classList.add('valid');
                } else {
                    nextButton.disabled = true;
                    obligatoryMessage.classList.remove('valid');
                }
            }

            function validateAddress(inputId, messageId) {
                const addressInput = document.getElementById(inputId);
                const obligatoryMessage = document.getElementById(messageId);

                if (/[a-z]/i.test(addressInput.value)) {
                    obligatoryMessage.classList.add('valid');
                } else {
                    obligatoryMessage.classList.remove('valid');
                }
            }

            function unlockQuestion(questionNumber, hideOptions = false) {
                const questionElement = document.querySelector(`[data-question="${questionNumber}"] select`);
                questionElement.disabled = false;
                if (hideOptions) {
                    const optionsDiv = document.getElementById(`question${questionNumber}-options`);
                    if (optionsDiv) {
                        optionsDiv.classList.add('hidden');
                    }
                }
            }

            function lockQuestion(questionNumber) {
                const questionElement = document.querySelector(`[data-question="${questionNumber}"] select`);
                questionElement.disabled = true;
            }
            
            function handleFormuleChange() {
                const formule = document.getElementById('formule').value;

                document.getElementById('question10-options').classList.add('hidden');
                document.getElementById('question14-options').classList.add('hidden');

                if (formule === 'economique') {
                    document.getElementById('question10-options').classList.remove('hidden');
                    document.getElementById('question14-options').classList.remove('hidden');
                    lockQuestion(10);
                    lockQuestion(14);
                } else if (formule === 'premium') {
                    document.getElementById('question10-options').classList.remove('hidden');
                    lockQuestion(10);
                    unlockQuestion(14);
                } else if (formule === 'prestige') {
                    unlockQuestion(10);
                    unlockQuestion(14);
                }
            }

        </script>

        <div id="page1" class="max-w-xl mx-auto mt-10 bg-white bg-opacity-70 shadow-md rounded-lg overflow-hidden">
            <div class="p-6 text-center">
                <h1>Rapide, Simple et Transparent Avec Movexpress</h1>
        <p class="text-gray-700 mb-4 text-base font-bold">OBTENEZ LE PRIX DE VOTRE DEVIS EN 5 MINUTES AVEC NOTRE APPLICATION.</p>
        <p class="text-gray-700 mb-6 text-base font-bold">RÉPONDEZ À 23 QUESTIONS ET DÉCOUVREZ VOTRE PRIX INSTANTANÉMENT.</p>
        <button class="navigation-button" onclick="showPage('page2')">Démarrer maintenant</button>
        <p class="text-green-500 mt-4 font-bold">95 Devis Réalisés la semaine dernière</p>
    </div>
        </div>

        <div id="page2" class="max-w-xl mx-auto mt-10 bg-white bg-opacity-80 shadow-md rounded-lg overflow-hidden hidden">
            <div class="p-6">
                <h1 class="text-2xl font-bold text-center text-blue-600 mb-6">Votre Déménagement Commence ici</h1>
                <div class="progress-bar">
                    <div id="progress" class="progress"></div>
                </div>
                <form id="devisForm" onsubmit="return false;">
                    <div class="form-group mb-4" data-question="1">
                        <label for="nom_prenom" class="block text-gray-700">1. Nom et Prénom :</label>
                        <input type="text" id="nom_prenom" class="w-full mt-1 p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500" placeholder="exemple : Alan Favre" required oninput="validateName()">
                        <p class="obligatory-message" id="name-obligatory"><i class="fas fa-exclamation-circle"></i> Champ obligatoire : veuillez compléter cette section avant de continuer.</p>
                        <div class="flex justify-between">
                            <button type="button" class="navigation-button next-button" onclick="nextQuestion()">Suivant</button>
                        </div>
                    </div>
                    <div class="form-group mb-4 hidden" data-question="2">
                        <label for="email" class="block text-gray-700">2. Adresse Mail :</label>
                        <input type="email" id="email" class="w-full mt-1 p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500" placeholder="exemple : alan.favre@exemple.com" required pattern="^[^\s@]+@[^\s@]+\.[^\s@]+$" title="Veuillez entrer une adresse email valide contenant @ et un domaine." oninput="validateEmail()">
                        <p class="obligatory-message" id="email-obligatory"><i class="fas fa-exclamation-circle"></i> Champ obligatoire : veuillez compléter cette section avant de continuer.</p>
                        <div class="flex justify-between">
                            <button type="button" class="navigation-button back-button" onclick="previousQuestion()">Retour</button>
                            <button type="button" class="navigation-button next-button" id="email-next-button" disabled onclick="nextQuestion()">Suivant</button>
                        </div>
                    </div>
                    <div class="form-group mb-4 hidden" data-question="3">
                        <label for="telephone" class="block text-gray-700">3. Numéro de Téléphone :</label>
                        <input type="tel" id="telephone" class="w-full mt-1 p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500" placeholder="exemple : 077 345 34 45" required pattern="^\d{10,15}$" title="Veuillez entrer un numéro de téléphone valide." oninput="validateTelephone()">
                        <p class="obligatory-message" id="telephone-obligatory"><i class="fas fa-exclamation-circle"></i> Champ obligatoire : veuillez compléter cette section avant de continuer.</p>
                        <div class="flex justify-between">
                            <button type="button" class="navigation-button back-button" onclick="previousQuestion()">Retour</button>
                            <button type="button" class="navigation-button next-button" id="telephone-next-button" disabled onclick="sendInitialData()">Suivant</button>
                        </div>
                    </div>
                    <div class="form-group mb-4 hidden" data-question="4">
                        <label for="adresse_actuelle" class="block text-gray-700">4. Votre Adresse Actuelle & Etage :</label>
                        <input type="text" id="adresse_actuelle" class="w-full mt-1 p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500" placeholder="exemple : Av Louis 5, 1400 Yverdon / 2ème étage" required oninput="validateAddress('adresse_actuelle', 'address1-obligatory')">
                        <p class="obligatory-message" id="address1-obligatory"><i class="fas fa-exclamation-circle"></i> Champ obligatoire : veuillez compléter cette section avant de continuer.</p>
                        <div class="flex justify-between">
                            <button type="button" class="navigation-button back-button" onclick="previousQuestion()">Retour</button>
                            <button type="button" class="navigation-button next-button" onclick="nextQuestion()">Suivant</button>
                        </div>
                    </div>
                    <div class="form-group mb-4 hidden" data-question="5">
                        <label for="adresse_future" class="block text-gray-700">5. Adresse de Destination & Etage :</label>
                        <input type="text" id="adresse_future" class="w-full mt-1 p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500" placeholder="exemple : Rue du Lac 8, 1003 Lausanne / 3ème étage" required oninput="validateAddress('adresse_future', 'address2-obligatory')">
                        <p class="obligatory-message" id="address2-obligatory"><i class="fas fa-exclamation-circle"></i> Champ obligatoire : veuillez compléter cette section avant de continuer.</p>
                        <div class="flex justify-between">
                            <button type="button" class="navigation-button back-button" onclick="previousQuestion()">Retour</button>
                            <button type="button" class="navigation-button next-button" onclick="nextQuestion()">Suivant</button>
                        </div>
                    </div>
                    <div class="form-group mb-4 hidden" data-question="6">
                        <label for="statut" class="block text-gray-700">6. Votre Statut :</label>
                        <select id="statut" class="w-full mt-1 p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500" required>
                            <option value="" disabled selected>Choisissez…</option>
                            <option value="Particulier">Particulier</option>
                            <option value="Entreprise">Entreprise</option>
                            <option value="Autre">Autre</option>
                        </select>
                        <div class="flex justify-between">
                            <button type="button" class="navigation-button back-button" onclick="previousQuestion()">Retour</button>
                            <button type="button" class="navigation-button next-button" onclick="nextQuestion()">Suivant</button>
                        </div>
                    </div>
                    <div class="form-group mb-4 hidden" data-question="7">
                        <label for="formule" class="block text-gray-700">7. Sélection de la Formule :</label>
                        <select id="formule" class="w-full mt-1 p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500" required onchange="handleFormuleChange()">
                            <option value="" disabled selected>Choisissez…</option>
                            <option value="economique">Économique (Chargement & Déchargement / Transport)</option>
                            <option value="premium">Premium (Chargement & Déchargement / Transport / Démontage et Remontage des meubles)</option>
                            <option value="prestige">Prestige (Chargement & Déchargement / Transport / Démontage et Remontage des meubles / Emballage & Déballage / Nettoyage fin de bail)</option>
                        </select>
                        <div class="flex justify-between">
                            <button type="button" class="navigation-button back-button" onclick="previousQuestion()">Retour</button>
                            <button type="button" class="navigation-button next-button" onclick="nextQuestion()">Suivant</button>
                        </div>
                    </div>
                    <div class="form-group mb-4 hidden" data-question="8">
                        <label for="objet" class="block text-gray-700">8. Type de Logement :</label>
                        <select id="objet" class="w-full mt-1 p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500" required onchange="handleObjetChange()">
                            <option value="" disabled selected>Choisissez…</option>
                            <option value="Appartement">Appartement</option>
                            <option value="Maison">Maison</option>
                            <option value="Locaux">Locaux</option>
                            <option value="Autre">Autre*</option>
                        </select>
                        <div id="sous-options-objet" class="nested-option hidden"></div>
                        <div class="flex justify-between">
                            <button type="button" class="navigation-button back-button" onclick="previousQuestion()">Retour</button>
                            <button type="button" class="navigation-button next-button" onclick="nextQuestion()">Suivant</button>
                        </div>
                    </div>
                    <div class="form-group mb-4 hidden" data-question="9">
                        <label for="pieces" class="block text-gray-700">9. Nombre de Pièces :</label>
                        <select id="pieces" class="w-full mt-1 p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500" required onchange="handlePiecesChange()">
                            <option value="" disabled selected>Choisissez…</option>
                            <option value="studio">Studio</option>
                            <option value="une_piece">Une pièce</option>
                            <option value="deux_pieces">Deux pièces</option>
                            <option value="trois_pieces">Trois pièces</option>
                            <option value="quatre_pieces">Quatre pièces</option>
                            <option value="cinq_pieces">Cinq pièces</option>
                            <option value="six_pieces">Six pièces</option>
                            <option value="sept_pieces">Sept pièces</option>
                            <option value="huit_pieces">Huit pièces</option>
                            <option value="neuf_pieces">Neuf pièces</option>
                            <option value="dix_pieces">Dix pièces</option>
                        </select>
                        <div id="sous-options-pieces" class="nested-option hidden"></div>
                        <div class="flex justify-between">
                            <button type="button" class="navigation-button back-button" onclick="previousQuestion()">Retour</button>
                            <button type="button" class="navigation-button next-button" onclick="nextQuestion()">Suivant</button>
                        </div>
                    </div>
                    <div class="form-group mb-4 hidden" data-question="10">
                        <label for="nettoyage" class="block text-gray-700">10. Service de Nettoyage :</label>
                        <select id="nettoyage" class="w-full mt-1 p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500" disabled>
                            <option value="" disabled selected>Choisissez…</option>
                            <option value="0">Pas de nettoyage</option>
                            <option value="30_49">30 m² à 49 m² (200chf)</option>
                            <option value="50_69">50 m² à 69 m² (350chf)</option>
                            <option value="70_89">70 m² à 89 m² (500chf)</option>
                            <option value="90_109">90 m² à 109 m² (650chf)</option>
                            <option value="110_129">110 m² à 129 m² (800chf)</option>
                            <option value="130_149">130 m² à 149 m² (950chf)</option>
                            <option value="150_169">150 m² à 169 m² (1100chf)</option>
                            <option value="170_189">170 m² à 189 m² (1250chf)</option>
                            <option value="190_209">190 m² à 209 m² (1400chf)</option>
                            <option value="210_229">210 m² à 229 m² (1550chf)</option>
                            <option value="plus_210">Plus de 230m²*</option>
                        </select>
                        <div id="question10-options" class="mt-2 text-center optional-question">
                            <p>Cette question est optionnelle à la formule choisie. Souhaitez-vous l’ajouter ?</p>
                            <button type="button" class="navigation-button" onclick="unlockQuestion(10, true)">Oui</button>
                            <button type="button" class="navigation-button" onclick="nextQuestion()">Non</button>
                        </div>
                        <div class="flex justify-between">
                            <button type="button" class="navigation-button back-button" onclick="previousQuestion()">Retour</button>
                            <button type="button" class="navigation-button next-button" onclick="nextQuestion()">Suivant</button>
                        </div>
                    </div>
                    <div class="form-group mb-4 hidden" data-question="11">
                        <label for="distance" class="block text-gray-700">11. Distance du Déménagement :</label>
                        <select id="distance" class="w-full mt-1 p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500" required>
                            <option value="" disabled selected>Choisissez…</option>
                            <option value="0_9">0-9 km (Gratuit)</option>
                            <option value="10_29">10-29 km (50chf)</option>
                            <option value="30_49">30-49 km (80chf)</option>
                            <option value="50_69">50-69 km (120chf)</option>
                            <option value="70_89">70-89 km (160chf)</option>
                            <option value="90_109">90-109 km (200chf)</option>
                            <option value="plus_110">Plus de 110km*</option>
                        </select>
                        <div class="flex justify-between">
                            <button type="button" class="navigation-button back-button" onclick="previousQuestion()">Retour</button>
                            <button type="button" class="navigation-button next-button" onclick="nextQuestion()">Suivant</button>
                        </div>
                    </div>
                    <div class="form-group mb-4 hidden" data-question="12">
                        <label for="lit_adulte" class="block text-gray-700">12. Nombre de Lits Adultes (90x200cm à 180x200cm) :</label>
                        <select id="lit_adulte" class="w-full mt-1 p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500" required>
                            <option value="" disabled selected>Choisissez…</option>
                            <option value="0">0</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6">6</option>
                            <option value="7">7</option>
                            <option value="8">8</option>
                            <option value="plus_de_huit">Plus de huit*</option>
                        </select>
                        <div class="flex justify-between">
                            <button type="button" class="navigation-button back-button" onclick="previousQuestion()">Retour</button>
                            <button type="button" class="navigation-button next-button" onclick="nextQuestion()">Suivant</button>
                        </div>
                    </div>
                    <div class="form-group mb-4 hidden" data-question="13">
                        <label for="lit_enfant" class="block text-gray-700">13. Nombre de Lits Enfants (70x140cm à 90x190cm):</label>
                        <select id="lit_enfant" class="w-full mt-1 p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500" required>
                            <option value="" disabled selected>Choisissez…</option>
                            <option value="0">0</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6">6</option>
                            <option value="7">7</option>
                            <option value="8">8</option>
                            <option value="plus_de_huit">Plus de huit*</option>
                        </select>
                        <div class="flex justify-between">
                            <button type="button" class="navigation-button back-button" onclick="previousQuestion()">Retour</button>
                            <button type="button" class="navigation-button next-button" onclick="nextQuestion()">Suivant</button>
                        </div>
                    </div>
                    <div class="form-group mb-4 hidden" data-question="14">
                        <label for="meubles" class="block text-gray-700">14. Nombre de meubles et d'armoires à habits de grande taille nécessitant démontage et remontage pour le transport (les lits ne comptent pas) :</label>
                        <select id="meubles" class="w-full mt-1 p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500" disabled>
                            <option value="" disabled selected>Choisissez…</option>
                            <option value="0">0 (0chf)</option>
                            <option value="1">1 (150chf)</option>
                            <option value="2">2 (300chf)</option>
                            <option value="3">3 (400chf)</option>
                            <option value="4">4 (500chf)</option>
                            <option value="5">5 (600chf)</option>
                            <option value="6">6 (700chf)</option>
                            <option value="7">7 (800chf)</option>
                            <option value="8">8 (900chf)</option>
                            <option value="plus_de_huit">Plus de huit* (à convenir)</option>
                        </select>
                        <div id="question14-options" class="mt-2 text-center optional-question">
                            <p>Cette question est optionnelle à la formule choisie. Souhaitez-vous l’ajouter ?</p>
                            <button type="button" class="navigation-button" onclick="unlockQuestion(14, true)">Oui</button>
                            <button type="button" class="navigation-button" onclick="nextQuestion()">Non</button>
                        </div>
                        <div class="flex justify-between">
                            <button type="button" class="navigation-button back-button" onclick="previousQuestion()">Retour</button>
                            <button type="button" class="navigation-button next-button" onclick="nextQuestion()">Suivant</button>
                        </div>
                    </div>
                    <div class="form-group mb-4 hidden" data-question="15">
                        <label for="canape" class="block text-gray-700">15. Type de Canapés :</label>
                        <select id="canape" class="w-full mt-1 p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500" required>
                            <option value="" disabled selected>Choisissez…</option>
                            <option value="0">Pas de canapés</option>
                            <option value="1">Canapé droit, trois places ou moins</option>
                            <option value="2">Canapé droit, plus de trois places</option>
                            <option value="3">Canapé d'angle</option>
                            <option value="4">Set de canapés 3+2+1</option>
                            <option value="autre">Autre*</option>
                        </select>
                        <div class="flex justify-between">
                            <button type="button" class="navigation-button back-button" onclick="previousQuestion()">Retour</button>
                            <button type="button" class="navigation-button next-button" onclick="nextQuestion()">Suivant</button>
                        </div>
                    </div>
                    <div class="form-group mb-4 hidden" data-question="16">
                        <label for="frigo" class="block text-gray-700">16. Nombre de réfrigérateurs, machines à laver, lave-vaisselle :</label>
                        <select id="frigo" class="w-full mt-1 p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500" required>
                            <option value="" disabled selected>Choisissez…</option>
                            <option value="0">0</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6">6</option>
                            <option value="7">7</option>
                            <option value="8">8</option>
                            <option value="plus_de_huit">Plus de huit*</option>
                        </select>
                        <div class="flex justify-between">
                            <button type="button" class="navigation-button back-button" onclick="previousQuestion()">Retour</button>
                            <button type="button" class="navigation-button next-button" onclick="nextQuestion()">Suivant</button>
                        </div>
                    </div>
                    <div class="form-group mb-4 hidden" data-question="17">
                        <label for="balcon" class="block text-gray-700">17. Présence d'un Balcon ou Terrasse :</label>
                        <select id="balcon" class="w-full mt-1 p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500" required>
                            <option value="" disabled selected>Choisissez…</option>
                            <option value="non">Non</option>
                            <option value="balcon">Oui, balcon</option>
                            <option value="terrasse">Oui, terrasse</option>
                        </select>
                        <div class="flex justify-between">
                            <button type="button" class="navigation-button back-button" onclick="previousQuestion()">Retour</button>
                            <button type="button" class="navigation-button next-button" onclick="nextQuestion()">Suivant</button>
                        </div>
                    </div>
                    <div class="form-group mb-4 hidden" data-question="18">
                        <label for="cave" class="block text-gray-700">18. Présence d'une Cave :</label>
                        <select id="cave" class="w-full mt-1 p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500" required>
                            <option value="" disabled selected>Choisissez…</option>
                            <option value="non">Non</option>
                            <option value="oui">Oui</option>
                        </select>
                        <div class="flex justify-between">
                            <button type="button" class="navigation-button back-button" onclick="previousQuestion()">Retour</button>
                            <button type="button" class="navigation-button next-button" onclick="nextQuestion()">Suivant</button>
                        </div>
                    </div>
                    <div class="form-group mb-4 hidden" data-question="19">
                        <label for="acces" class="block text-gray-700">19. Conditions d'Accès au Bâtiment :</label>
                        <select id="acces" class="w-full mt-1 p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500" required>
                            <option value="" disabled selected>Choisissez…</option>
                            <option value="facile">Facile</option>
                            <option value="difficile">Difficile*</option>
                        </select>
                        <div class="flex justify-between">
                            <button type="button" class="navigation-button back-button" onclick="previousQuestion()">Retour</button>
                            <button type="button" class="navigation-button next-button" onclick="nextQuestion()">Suivant</button>
                        </div>
                    </div>
                    <div class="form-group mb-4 hidden" data-question="20">
                        <label for="ascenseur" class="block text-gray-700">20. Ascenseur Disponible dans Le Bâtiment :</label>
                        <select id="ascenseur" class="w-full mt-1 p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500" required>
                            <option value="" disabled selected>Choisissez…</option>
                            <option value="rez_de_chaussee">Rez-de-chaussée</option>
                            <option value="deux_adresses">Oui aux deux adresses</option>
                            <option value="une_adresse">Oui à une seule adresse</option>
                            <option value="non">Non</option>
                        </select>
                        <div class="flex justify-between">
                            <button type="button" class="navigation-button back-button" onclick="previousQuestion()">Retour</button>
                            <button type="button" class="navigation-button next-button" onclick="nextQuestion()">Suivant</button>
                        </div>
                    </div>
                    <div class="form-group mb-4 hidden" data-question="21">
                        <label for="monte_charge" class="block text-gray-700">21. Monte-Meuble Nécessaire :</label>
                        <select id="monte_charge" class="w-full mt-1 p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500" required>
                            <option value="" disabled selected>Choisissez…</option>
                            <option value="non">Non</option>
                            <option value="oui">Oui</option>
                        </select>
                        <div class="flex justify-between">
                            <button type="button" class="navigation-button back-button" onclick="previousQuestion()">Retour</button>
                            <button type="button" class="navigation-button next-button" onclick="nextQuestion()">Suivant</button>
                        </div>
                    </div>
                    <div class="form-group mb-4 hidden" data-question="22">
                        <label for="cartons" class="block text-gray-700">22. Formule Cartons : (Nous vous livrons les cartons à votre adresse gratuitement)</label>
                        <select id="cartons" class="w-full mt-1 p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500" required>
                            <option value="" disabled selected>Choisissez…</option>
                            <option value="non">Non</option>
                            <option value="formule_m">Formule M (lot de 10 cartons) à 49.-</option>
                            <option value="formule_l">Formule L (lot de 30 cartons) à 138.-</option>
                            <option value="formule_xl">Formule XL (lot de 60 cartons) à 270.-</option>
                        </select>
                        <div class="flex justify-between">
                            <button type="button" class="navigation-button back-button" onclick="previousQuestion()">Retour</button>
                            <button type="button" class="navigation-button next-button" onclick="nextQuestion()">Suivant</button>
                        </div>
                    </div>
                    <div class="form-group mb-4 hidden" data-question="23">
                        <label for="commentaires" class="block text-gray-700">23. Commentaires ou Informations Supplémentaires :</label>
                        <input type="text" id="commentaires" class="w-full mt-1 p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500" placeholder="Toute information supplémentaire">
                        <div class="flex justify-between">
                            <button type="button" class="navigation-button back-button" onclick="previousQuestion()">Retour</button>
                            <button type="button" class="navigation-button next-button" onclick="validateForm()">Connaitre le coût de mon déménagement</button>
                        </div>
                    </div>
                </form>
                <p id="resultat" class="mt-4 text-xl text-center"></p>
                <div class="error-message text-red-500 hidden" id="error-message">Veuillez remplir tous les champs requis.</div>
                <div class="confirmation-message text-green-500 hidden" id="confirmation-message">Confirmation de l'envoi</div>
            </div>
        </div>

        <div id="page3" class="max-w-xl mx-auto mt-10 bg-white shadow-md rounded-lg overflow-hidden hidden">
            <div class="p-6 text-center">
                <h1 class="text-2xl font-bold text-blue-600 mb-6">Votre Déménagement Pour Seulement <span class="discounted-price" id="originalCost"></span> CHF</h1>
                <p class="discounted-price text-2xl mb-4"><span id="discountedPrice"></span> CHF</p>
                <p id="discount-message" class="promotion-message hidden">Rabais de 10% sur nos offres de janvier !</p>
                <p class="text-gray-700 mb-6">L&J Déménagement vous remercie pour votre fidélité</p>
                
                <!-- Champ de saisie pour le code promo -->
                <div class="promo-code-section mb-4">
                    <input type="text" id="promo-code" placeholder="Code Promo" class="promo-input">
                    <button id="apply-promo" class="hidden bg-green-500 text-white py-2 px-4 rounded-md hover:bg-green-600">Appliquer</button>
                </div>
        
                <!-- Message de notification pour le code promo -->
                <div id="promo-notification" class="notification"></div>
        
                <!-- Boutons et liens -->
                <button class="bg-green-500 text-white py-2 px-4 mb-4 rounded-md hover:bg-green-600" onclick="window.location.href='https://calendly.com/ljdemenagement'">Je souhaite organiser une visioconférence pour valider mon devis</button>
                <div class="mb-4">
                    <button class="bg-blue-500 text-white py-2 px-4 rounded-md hover:bg-blue-600" onclick="window.location.href='https://ljdemenagement.com'">Site Web</button>
                    <button class="bg-blue-500 text-white py-2 px-4 rounded-md hover:bg-blue-600" onclick="window.location.href='https://ljdemenagement.com/boutique'">La Boutique L&J Déménagement</button>
                </div>
        
                <!-- Icônes sociales -->
                <div class="social-icons">
                    <a href="https://www.facebook.com/share/19uEbazn1Q/" target="_blank">
                        <i class="fab fa-facebook-f"></i>
                    </a>
                    <a href="https://www.instagram.com/ljdemenagement01?igsh=ZjZtdTRqdmJsNXk=" target="_blank">
                        <i class="fab fa-instagram"></i>
                    </a>
                    <a href="https://www.tiktok.com/@lj.demenagement?_t=ZN-8tvKSX4GP4Q&_r=1" target="_blank">
                        <i class="fab fa-tiktok"></i>
                    </a>
                    <a href="https://youtube.com/@ljdemenagement?si=qsAm-QkHyJLUB_fL" target="_blank">
                        <i class="fab fa-youtube"></i>
                    </a>
                </div>
                <p>Votre avis compte ! <a href="https://g.co/kgs/Cug2Dpz" target="_blank" class="text-blue-500 hover:underline">Laissez un feedback sur Google.</a></p>
                <p id="additional-cost-message" class="text-red-500 mt-4 hidden">Vous avez choisi des options qui peuvent entraîner des coûts supplémentaires.</p>
            </div>
        </div>

        <div id="confirmation-message" class="notification hidden"></div>
        <div id="notification" class="notification hidden"></div>

        <script>
            function validateForm() {
                const email = document.getElementById('email').value;
                const telephone = document.getElementById('telephone').value;

                if (!email || !telephone) {
                    document.getElementById('error-message').style.display = 'block';
                    setTimeout(() => {
                        document.getElementById('error-message').style.display = 'none';
                    }, 3000);
                    return;
                }

                const cost = calculateCost();
                saveForm(cost);
                checkAdditionalCost();
            }

            function calculateCost() {
                let cost = 0;
                const formule = document.getElementById('formule').value;
                const pieces = document.getElementById('pieces').value;
                const cartons = document.getElementById('cartons').value;
                const nettoyage = document.getElementById('nettoyage').value;
                const distance = document.getElementById('distance').value;
                const lit_adulte = document.getElementById('lit_adulte').value;
                const lit_enfant = document.getElementById('lit_enfant').value;
                const meubles = document.getElementById('meubles').value;
                const canape = document.getElementById('canape').value;
                const frigo = document.getElementById('frigo').value;
                const balcon = document.getElementById('balcon').value;
                const cave = document.getElementById('cave').value;
                const acces = document.getElementById('acces').value;
                const ascenseur = document.getElementById('ascenseur').value;
                const monte_charge = document.getElementById('monte_charge').value;

                if (formule === 'economique') cost += 0;
                else if (formule === 'premium') cost += 0;
                else if (formule === 'prestige') cost += cost * 1;

                const piecesCost = {
                    studio: 450,
                    une_piece: 600,
                    deux_pieces: 800,
                    trois_pieces: 1150,
                    quatre_pieces: 1450,
                    cinq_pieces: 1800,
                    six_pieces: 2200,
                    sept_pieces: 2450,
                    huit_pieces: 2700,
                    neuf_pieces: 3050,
                    dix_pieces: 3400
                };

                cost += piecesCost[pieces] || 0;

                const superficieElement = document.querySelector(`#sous-options-pieces select`);
                if (superficieElement) {
                    const selectedOption = superficieElement.options[superficieElement.selectedIndex];
                    const baseCost = piecesCost[pieces] || 0;
                    const additionalCostPercentage = parseFloat(selectedOption.dataset.cost) / 100;
                    cost += baseCost * additionalCostPercentage;
                }

                const nettoyageCosts = {
                    '30_49': 200,
                    '50_69': 350,
                    '70_89': 500,
                    '90_109': 650,
                    '110_129': 800,
                    '130_149': 1000,
                    '150_169': 1350,
                    '170_189': 1700,
                    '190_209': 2050,
                    'plus_210': 2400
                };
                cost += nettoyageCosts[nettoyage] || 0;

                const distanceCosts = {
                    '0_9': 0,
                    '10_29': 50,
                    '30_49': 80,
                    '50_69': 120,
                    '70_89': 160,
                    '90_109': 200,
                    'plus_110': 300
                };
                cost += distanceCosts[distance] || 0;

                const cartonsCosts = {
                    'formule_m': 49,
                    'formule_l': 138,
                    'formule_xl': 270
                };
                cost += cartonsCosts[cartons] || 0;

                const litAdulteCosts = {
                    '0': 0,
                    '1': 0,
                    '2': 0,
                    '3': 100,
                    '4': 150,
                    '5': 200,
                    '6': 250,
                    '7': 300,
                    '8': 350,
                    'plus_de_huit': 400
                };
                cost += litAdulteCosts[lit_adulte] || 0;

                const litEnfantCosts = {
                    '0': 0,
                    '1': 0,
                    '2': 0,
                    '3': 50,
                    '4': 75,
                    '5': 100,
                    '6': 125,
                    '7': 150,
                    '8': 175,
                    'plus_de_huit': 200
                };
                cost += litEnfantCosts[lit_enfant] || 0;

                const meubleCosts = {
                    '0': 0,
                    '1': 150,
                    '2': 300,
                    '3': 450,
                    '4': 600,
                    '5': 750,
                    '6': 900,
                    '7': 1050,
                    '8': 1200,
                    'plus_de_huit': 1350
                };
                cost += meubleCosts[meubles] || 0;

                const canapeCosts = {
                    '0': -50,
                    '1': 0,
                    '2': 0,
                    '3': 25,
                    '4': 50,
                    'autre': 0
                };
                cost += canapeCosts[canape] || 0;

                const frigoCosts = {
                    '0': 0,
                    '1': 0,
                    '2': 25,
                    '3': 50,
                    '4': 75,
                    '5': 100,
                    '6': 125,
                    '7': 150,
                    '8': 200,
                    'plus_de_huit': 400
                };
                cost += frigoCosts[frigo] || 0;

                if (balcon === 'balcon') cost += cost * 0.10;
                if (balcon === 'terrasse') cost += cost * 0.15;
                if (cave === 'oui') cost += cost * 0.10;
                if (acces === 'difficile') cost += cost * 0.20;
                if (ascenseur === 'non') cost += cost * 0.10;
                else if (ascenseur === 'une_adresse') cost += cost * 0.05;
                if (monte_charge === 'oui') cost += 700;

                const originalCost = cost;

                const today = new Date();
                let discountedCost = cost;
                if (today.getMonth() === 0) {
                    discountedCost *= 0.90;
                    document.getElementById('discount-message').classList.remove('hidden');
                }

                const roundedCost = Math.floor(discountedCost * 10) / 10;

                document.getElementById('originalCost').innerText = originalCost.toFixed(2);
                document.getElementById('discountedPrice').innerText = discountedCost.toFixed(2);

                return cost;
            }

            function saveForm(cost) {
                const formDetails = {
                    Nom_prenom: document.getElementById('nom_prenom').value,
                    Email: document.getElementById('email').value,
                    Telephone: document.getElementById('telephone').value,
                    Adresse_actuelle: document.getElementById('adresse_actuelle').value,
                    Adresse_future: document.getElementById('adresse_future').value,
                    Statut: document.getElementById('statut').value,
                    Formule: document.getElementById('formule').value,
                    Objet: document.getElementById('objet').value,
                    Etages: document.getElementById('sous-options-objet').querySelector('select') ? document.getElementById('sous-options-objet').querySelector('select').value : '',
                    Pieces: document.getElementById('pieces').value,
                    Superficie: document.getElementById('sous-options-pieces').querySelector('select') ? document.getElementById('sous-options-pieces').querySelector('select').value : '',
                    Nettoyage: document.getElementById('nettoyage').value,
                    Distance: document.getElementById('distance').value,
                    Lit_adulte: document.getElementById('lit_adulte').value,
                    Lit_enfant: document.getElementById('lit_enfant').value,
                    Meubles: document.getElementById('meubles').value,
                    Canape: document.getElementById('canape').value,
                    Frigo: document.getElementById('frigo').value,
                    Balcon: document.getElementById('balcon').value,
                    Cave: document.getElementById('cave').value,
                    Acces: document.getElementById('acces').value,
                    Ascenseur: document.getElementById('ascenseur').value,
                    Monte_charge: document.getElementById('monte_charge').value,
                    Cartons: document.getElementById('cartons').value,
                    Commentaires: document.getElementById('commentaires').value,
                    Estimated_cost: cost
                };

                const message = `
                    Madame, Monsieur, 

                    Nous vous remercions d'avoir utilisé notre application de devis instantané chez L&J Déménagement. Nous sommes heureux de vous fournir les réponses au formulaire et le prix estimé pour votre déménagement :

                    Nom et Prénom: ${formDetails.Nom_prenom}
                    Email: ${formDetails.Email}
                    Téléphone: ${formDetails.Telephone}
                    Adresse Actuelle: ${formDetails.Adresse_actuelle}
                    Adresse Future: ${formDetails.Adresse_future}
                    Statut: ${formDetails.Statut}
                    Formule: ${formDetails.Formule}
                    Objet: ${formDetails.Objet} - Nombre d'étages: ${formDetails.Etages}
                    Pièces: ${formDetails.Pieces} - Superficie: ${formDetails.Superficie}
                    Nettoyage: ${formDetails.Nettoyage}
                    Distance: ${formDetails.Distance}
                    Lits Adultes: ${formDetails.Lit_adulte}
                    Lits Enfants: ${formDetails.Lit_enfant}
                    Meubles: ${formDetails.Meubles}
                    Canapé: ${formDetails.Canape}
                    Frigo: ${formDetails.Frigo}
                    Balcon: ${formDetails.Balcon}
                    Cave: ${formDetails.Cave}
                    Accès: ${formDetails.Acces}
                    Ascenseur: ${formDetails.Ascenseur}
                    Monte Charge: ${formDetails.Monte_charge}
                    Cartons: ${formDetails.Cartons}
                    Commentaires: ${formDetails.Comments}
                    Coût Estimé: ${formDetails.Estimated_cost} CHF

                    Nous vous assurons que notre équipe dévouée mettra tout en œuvre pour rendre votre déménagement aussi fluide et serein que possible. Nous vous offrons un service de qualité, alliant professionnalisme et soin.

                    Votre mandat de déménagement :

                    Pour confirmer votre déménagement avec nous, veuillez répondre à cet e-mail ou nous contacter directement par téléphone au +41 78 749 35 94. Un membre de notre équipe se fera un plaisir de finaliser les détails avec vous.

                    En acceptant notre mandat, vous aurez accès à :

                    - Une planification sur mesure de votre déménagement.
                    - Un interlocuteur dédié pour répondre à toutes vos questions.
                    - Des conseils pratiques pour préparer votre départ.

                    Nous restons à votre disposition pour toute information complémentaire. N'hésitez pas à visiter notre site web https://ljdemenagement.com pour plus d'informations sur nos services.

                    Merci de nous faire confiance pour votre projet de déménagement. Nous espérons avoir bientôt le plaisir de vous accompagner dans cette nouvelle étape de votre vie.

                    Cordialement,

                    L'équipe L&J Déménagement
                `;

                emailjs.send("service_wd4pvu4", "template_e3f3f4p", {
                    to_email: formDetails.Email,
                    from_name: "L&J Déménagement",
                    reply_to: formDetails.Email,
                    subject: "Demande de devis de L&J Déménagement",
                    message: message
                }).then((response) => {
                    console.log('SUCCESS!', response.status, response.text);
                    showConfirmationMessage();
                    showPage('page3');
                }, (err) => {
                    console.error('FAILED...', err);
                    showNotification("Échec de l'envoi du formulaire.", 'error');
                });
            }

            function checkAdditionalCost() {
                const optionsWithAsterisk = ['halle_industriel', 'bureau', 'usine', 'autre', 'plus_de_100m²', 'plus_de_110m²', 'plus_de_120m²', 'plus_de_130m²', 
                    'plus_de_140m²', 'plus_de_150m²', 'plus_de_160m²', 'plus_de_170m²', 'plus_de_180m²', 'plus_de_200m²', 'plus_de_220m²', 'plus_de_240m²', 
                    'plus_de_250m²', 'plus_de_300m²', 'plus_de_330m²', 'plus_de_400m²', 'plus_de_500m²', 'plus_de_600m²', 'plus_de_700m²', 'plus_de_800m²', 
                    'plus_de_1000m²', 'difficile', 'plus_110', 'plus_210', 'plus_de_huit'];

                const selectedOptions = Array.from(document.querySelectorAll('select')).map(select => select.value);
                const hasAsteriskOption = selectedOptions.some(option => optionsWithAsterisk.includes(option));

                if (hasAsteriskOption) {
                    document.getElementById('additional-cost-message').classList.remove('hidden');
                } else {
                    document.getElementById('additional-cost-message').classList.add('hidden');
                }
            }

            function showConfirmationMessage() {
                const confirmationMessage = document.getElementById('confirmation-message');
                confirmationMessage.style.display = 'block';
                confirmationMessage.innerText = "Confirmation de l'envoi";
                setTimeout(() => {
                    confirmationMessage.style.display = 'none';
                }, 3000);
            }

            function markContacted() {
                const email = document.getElementById('email').value;

                emailjs.send("service_wd4pvu4", "template_e3f3f4p", {
                    reply_to: email,
                    from_name: "L&J Déménagement",
                    subject: "Demande de contact",
                    message: "Vous serez contacté par un agent de L&J Déménagement."
                }).then((response) => {
                    console.log('SUCCESS!', response.status, response.text);
                    alert('Votre demande a été envoyée avec succès !');
                }, (err) => {
                    console.error('FAILED...', err);
                    alert("Échec de l'envoi de la demande.");
                });
            }

            function showNotification(message, type) {
                const notification = document.getElementById('notification');
                notification.className = `notification ${type}`;
                notification.innerText = message;
                notification.style.display = 'block';
                setTimeout(() => {
                    notification.style.display = 'none';
                }, 3000);
            }

            function handleObjetChange() {
                const objet = document.getElementById('objet').value;
                const sousOptionsDiv = document.getElementById('sous-options-objet');
                sousOptionsDiv.innerHTML = '';

                if (objet === "Appartement") {
                    sousOptionsDiv.innerHTML = `
                        <label class="block text-gray-700">Combien d'étages ?</label>
                        <select id="etages_appartement" class="w-full mt-1 p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500">
                            <option value="un_etage" data-cost="0">Un étage</option>
                            <option value="duplex" data-cost="10">Duplex</option>
                            <option value="triplex" data-cost="20">Triplex</option>
                        </select>`;
                } else if (objet === "Maison") {
                    sousOptionsDiv.innerHTML = `
                        <label class="block text-gray-700">Combien d'étages ?</label>
                        <select id="etages_maison" class="w-full mt-1 p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500">
                            <option value="plein_pied" data-cost="0">Plein pied</option>
                            <option value="deux_etages" data-cost="10">Deux étages</option>
                            <option value="trois_etages" data-cost="20">Trois étages</option>
                        </select>
                        <label class="block text-gray-700 mt-2">J'ai un sous-sol</label>
                        <input type="checkbox" id="sous_sol" class="mt-1" onclick="updateCostForSousSol()">`;
                } else if (objet === "Locaux") {
                    sousOptionsDiv.innerHTML = `
                        <label class="block text-gray-700">Type de locaux :</label>
                        <select id="type_locaux" class="w-full mt-1 p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500" onchange="handleTypeLocauxChange()">
                            <option value="halle_industriel">Halle industriel*</option>
                            <option value="bureau">Bureau*</option>
                            <option value="usine">Usine*</option>
                        </select>
                        <div id="sous-options-locaux" class="nested-option hidden">
                            <label class="block text-gray-700 mt-2">Combien d'étages ?</label>
                            <select id="etages_locaux" class="w-full mt-1 p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500">
                                <option value="un_etage" data-cost="0">Un étage</option>
                                <option value="deux_etages" data-cost="20">Deux étages</option>
                                <option value="trois_etages" data-cost="30">Trois étages</option>
                            </select>
                        </div>`;
                }
                sousOptionsDiv.classList.remove('hidden');
            }

            function handleTypeLocauxChange() {
                const typeLocaux = document.getElementById('type_locaux').value;
                const sousOptionsLocaux = document.getElementById('sous-options-locaux');
                if (typeLocaux) {
                    sousOptionsLocaux.classList.remove('hidden');
                } else {
                    sousOptionsLocaux.classList.add('hidden');
                }
            }

            function handlePiecesChange() {
                const pieces = document.getElementById('pieces').value;
                const sousOptionsDiv = document.getElementById('sous-options-pieces');
                sousOptionsDiv.innerHTML = '';

                const pieceOptions = {
                    studio: `
                        <label class="block text-gray-700">Superficie :</label>
                        <select id="superficie_studio" class="w-full mt-1 p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500">
                            <option value="moins_de_49" data-cost="0">Moins de 49m²</option>
                            <option value="50_59" data-cost="30">50m² à 59m²</option>
                            <option value="60_69" data-cost="40">60m² à 69m²</option>
                            <option value="70_80" data-cost="50">70m² à 80m²</option>
                        </select>`,
                    une_piece: `
                        <label class="block text-gray-700">Superficie :</label>
                        <select id="superficie_une_piece" class="w-full mt-1 p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500">
                            <option value="moins_de_49" data-cost="0">Moins de 49m²</option>
                            <option value="50_59" data-cost="10">50m² à 59m²</option>
                            <option value="60_69" data-cost="40">60m² à 69m²</option>
                            <option value="70_79" data-cost="100">70m² à 79m²</option>
                            <option value="80_89" data-cost="130">80m² à 89m²</option>
                            <option value="90_99" data-cost="160">90m² à 99m²</option>
                            <option value="plus_de_100m²" data-cost="190">Plus de 100m²*</option>
                        </select>`,
                    deux_pieces: `
                        <label class="block text-gray-700">Superficie :</label>
                        <select id="superficie_deux_pieces" class="w-full mt-1 p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500">
                            <option value="moins_de_79" data-cost="0">Moins de 79m²</option>
                            <option value="80_89" data-cost="40">80m² à 89m²</option>
                            <option value="90_99" data-cost="70">90m² à 99m²</option>
                            <option value="100_109" data-cost="90">100m² à 109m²</option>
                            <option value="plus_de_110m²" data-cost="130">Plus de 110m²*</option>
                        </select>`,
                    trois_pieces: `
                        <label class="block text-gray-700">Superficie :</label>
                        <select id="superficie_trois_pieces" class="w-full mt-1 p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500">
                            <option value="moins_de_79" data-cost="0">Moins de 79m²</option>
                            <option value="80_89" data-cost="10">80m² à 89m²</option>
                            <option value="90_99" data-cost="20">90m² à 99m²</option>
                            <option value="100_109" data-cost="30">100m² à 109m²</option>
                            <option value="110_119" data-cost="40">110m² à 119m²</option>
                            <option value="plus_de_120m²" data-cost="50">Plus de 120m²*</option>
                        </select>`,
                    quatre_pieces: `
                        <label class="block text-gray-700">Superficie :</label>
                        <select id="superficie_quatre_pieces" class="w-full mt-1 p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500">
                            <option value="moins_de_109" data-cost="0">Moins de 109m²</option>
                            <option value="110_119" data-cost="5">110m² à 119m²</option>
                            <option value="120_129" data-cost="10">120m² à 129m²</option>
                            <option value="130_139" data-cost="15">130m² à 139m²</option>
                            <option value="140_149" data-cost="20">140m² à 149m²</option>
                            <option value="plus_de_150m²" data-cost="25">Plus de 150m²*</option>
                        </select>`,
                    cinq_pieces: `
                        <label class="block text-gray-700">Superficie :</label>
                        <select id="superficie_cinq_pieces" class="w-full mt-1 p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500">
                            <option value="moins_de_119" data-cost="0">Moins de 119m²</option>
                            <option value="120_129" data-cost="10">120m² à 129m²</option>
                            <option value="130_139" data-cost="20">130m² à 139m²</option>
                            <option value="140_149" data-cost="30">140m² à 149m²</option>
                            <option value="150_159" data-cost="40">150m² à 159m²</option>
                            <option value="plus_de_160m²" data-cost="50">Plus de 160m²*</option>
                        </select>`,
                    six_pieces: `
                        <label class="block text-gray-700">Superficie :</label>
                        <select id="superficie_six_pieces" class="w-full mt-1 p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500">
                            <option value="moins_de_149" data-cost="0">Moins de 149m²</option>
                            <option value="150_159" data-cost="10">150m² à 159m²</option>
                            <option value="160_169" data-cost="20">160m² à 169m²</option>
                            <option value="170_179" data-cost="30">170m² à 179m²</option>
                            <option value="180_189" data-cost="40">180m² à 189m²</option>
                            <option value="plus_de_190m²" data-cost="50">Plus de 190m²*</option>
                        </select>`,
                    sept_pieces: `
                        <label class="block text-gray-700">Superficie :</label>
                        <select id="superficie_sept_pieces" class="w-full mt-1 p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500">
                            <option value="moins_de_169" data-cost="0">Moins de 169m²</option>
                            <option value="170_179" data-cost="10">170m² à 179m²</option>
                            <option value="180_189" data-cost="20">180m² à 189m²</option>
                            <option value="190_199" data-cost="30">190m² à 199m²</option>
                            <option value="200_209" data-cost="40">200m² à 209m²</option>
                            <option value="plus_de_210m²" data-cost="50">Plus de 210m²*</option>
                        </select>`,
                    huit_pieces: `
                        <label class="block text-gray-700">Superficie :</label>
                        <select id="superficie_huit_pieces" class="w-full mt-1 p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500">
                            <option value="moins_de_189" data-cost="0">Moins de 189m²</option>
                            <option value="190_199" data-cost="10">190m² à 199m²</option>
                            <option value="200_209" data-cost="20">200m² à 209m²</option>
                            <option value="210_219" data-cost="30">210m² à 219m²</option>
                            <option value="220_229" data-cost="40">220m² à 229m²</option>
                            <option value="plus_de_230m²" data-cost="50">Plus de 230m²*</option>
                        </select>`,
                    neuf_pieces: `
                        <label class="block text-gray-700">Superficie :</label>
                        <select id="superficie_neuf_pieces" class="w-full mt-1 p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500">
                            <option value="moins_de_209" data-cost="0">Moins de 209m²</option>
                            <option value="210_219" data-cost="10">210m² à 219m²</option>
                            <option value="220_229" data-cost="20">220m² à 229m²</option>
                            <option value="230_239" data-cost="30">230m² à 239m²</option>
                            <option value="240_249" data-cost="40">240m² à 249m²</option>
                            <option value="plus_de_250m²" data-cost="50">Plus de 250m²*</option>
                        </select>`,
                    dix_pieces: `
                        <label class="block text-gray-700">Superficie :</label>
                        <select id="superficie_dix_pieces" class="w-full mt-1 p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500">
                            <option value="moins_de_229" data-cost="0">Moins de 229m²</option>
                            <option value="230_239" data-cost="5">230m² à 239m²</option>
                            <option value="240_249" data-cost="10">240m² à 249m²</option>
                            <option value="250_259" data-cost="20">250m² à 259m²</option>
                            <option value="260_269" data-cost="30">260m² à 269m²</option>
                            <option value="plus_de_270m²" data-cost="40">Plus de 270m²*</option>
                        </select>`
                };

                sousOptionsDiv.innerHTML = pieceOptions[pieces];
                sousOptionsDiv.classList.remove('hidden');
            }

            function updateCostForSousSol() {
                const sousSolCheckbox = document.getElementById('sous_sol');
                const baseCost = 100;
                const currentPrice = parseFloat(document.getElementById('prixDevis').innerText || "0");
                if (sousSolCheckbox.checked) {
                    document.getElementById('prixDevis').innerText = (currentPrice + baseCost).toFixed(2);
                } else {
                    document.getElementById('prixDevis').innerText = (currentPrice - baseCost).toFixed(2);
                }
            }

            const whatsappButton = document.createElement('a');
            whatsappButton.href = "https://api.whatsapp.com/send?phone=41774786342";
            whatsappButton.target = "_blank";
            whatsappButton.innerHTML = '<button class="whatsapp-button"><i class="fab fa-whatsapp"></i></button>';
            document.body.appendChild(whatsappButton);

            // JavaScript pour le code promo
            document.getElementById("promo-code").addEventListener("input", function() {
                const promoCode = this.value.trim();
                const applyButton = document.getElementById("apply-promo");

                // Vérifier si le code contient au moins 2 lettres et 2 chiffres
                const hasTwoLetters = promoCode.replace(/[^a-zA-Z]/g, "").length >= 2;
                const hasTwoNumbers = promoCode.replace(/[^0-9]/g, "").length >= 2;

                if (hasTwoLetters && hasTwoNumbers) {
                    applyButton.classList.remove("hidden");
                } else {
                    applyButton.classList.add("hidden");
                }
            });

            document.getElementById("apply-promo").addEventListener("click", function() {
                const promoCode = document.getElementById("promo-code").value.trim();
                const discount = 0.10; // 10% de réduction
                const validPromoCodes = ["joel10", "larouetourne10"];
                const originalPriceElement = document.getElementById("originalCost");
                const discountedPriceElement = document.getElementById("discountedPrice");
                const promoNotification = document.getElementById("promo-notification");

                const originalPrice = parseFloat(originalPriceElement.textContent.replace('CHF', ''));

                promoNotification.textContent = "";

                if (validPromoCodes.includes(promoCode)) {
                    promoNotification.className = "notification success";
                    promoNotification.textContent = "Code accepté, vous bénéficiez de -10%";
                    promoNotification.style.display = 'block';
                    setTimeout(() => {
                        promoNotification.style.display = 'none';
                    }, 3000);

                    const discountedPrice = originalPrice * (1 - discount);
                    
                    originalPriceElement.classList.add('original-price');
                    discountedPriceElement.textContent = discountedPrice.toFixed(2) + ' CHF';

                    emailjs.send("service_wd4pvu4", "template_e3f3f4p", {
                        to_email: document.getElementById('email').value,
                        from_name: "L&J Déménagement",
                        reply_to: document.getElementById('email').value,
                        subject: "Demande de devis de L&J Déménagement avec Code Promo",
                        message: `Le code promo ${promoCode} a été utilisé pour une réduction de 10%.\n\n
                                  Nom et Prénom: ${document.getElementById('nom_prenom').value}\n
                                  Email: ${document.getElementById('email').value}\n
                                  Téléphone: ${document.getElementById('telephone').value}`
                    }).then(function(response) {
                        console.log("Email envoyé avec succès !", response.status, response.text);
                    }, function(error) {
                        console.log("Échec de l'envoi de l'email.", error);
                    });
                } else {
                    promoNotification.className = "notification error";
                    promoNotification.textContent = "Code pas valable";
                    promoNotification.style.display = 'block';
                    setTimeout(() => {
                        promoNotification.style.display = 'none';
                    }, 3000);
                }
            });

            // Initialiser les gestionnaires d'événements
            function init() {
                handleFormuleChange();
                handleObjetChange();
                handlePiecesChange();
            }

            // Appeler la fonction d'initialisation lorsque le DOM est prêt
            document.addEventListener('DOMContentLoaded', init);
        </script>
    </div>
</body>
</html>