<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XL Clean Sofa</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <style>
        .progress-bar {
            width: 100%;
            height: 8px;
            background-color: #e5e7eb;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .progress {
            height: 8px;
            background-color: #ec4899;
            width: 0%;
            border-radius: 5px;
            transition: width 0.4s ease;
        }
        .hidden {
            display: none;
        }
        .navigation-button {
            display: inline-block;
            margin: 5px;
            padding: 8px 16px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .next-button {
            background-color: #ec4899;
            color: white;
        }
        .back-button {
            background-color: #a0aec0;
            color: white;
        }
        .whatsapp-button {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: #25D366;
            color: white;
            border: none;
            border-radius: 50%;
            padding: 15px;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
        }
        .video-background {
            position: fixed;
            top: -1.7cm;
            left: -2.01cm;
            width: 100vw;
            height: 100vh;
            z-index: -1;
            pointer-events: none;
        }

        @media (max-width: 768px) {
        .video-background {
            top: calc(-1.7cm - 1cm);
            }
        }
        .video-background iframe {
            width: 116%;
            height: 116%;
            object-fit: cover;
        }
        .content-container {
            position: relative;
            z-index: 1;
            background-color: rgba(255, 255, 255, 0.8);
            padding: 20px;
            border-radius: 10px;
        }
    </style>
</head>

<body class="bg-gray-100 font-sans antialiased">
    <div class="video-background">
        <iframe id="video-frame" width="100%" height="100%" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
    </div>

    <div class="content-container">
        <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
        <script type="text/javascript">
            (function () {
                emailjs.init("YOUR_NEW_USER_ID");
                detectDeviceAndSetVideo();
            })();

            function detectDeviceAndSetVideo() {
                const videoFrame = document.getElementById('video-frame');
                if (window.innerWidth <= 768) {
                    videoFrame.src = "YOUR_NEW_VIDEO_URL_MOBILE"; // Mobile video URL
                } else {
                    videoFrame.src = "YOUR_NEW_VIDEO_URL_DESKTOP"; // Desktop video URL
                }
            }

            function sendInitialData() {
                const nomPrenom = document.getElementById('nom_prenom').value;
                const email = document.getElementById('email').value;
                const telephone = document.getElementById('telephone').value;

                const message = `
                    Voici les trois premières réponses du formulaire de nettoyage de canapés :

                    Nom et Prénom: ${nomPrenom}
                    Adresse Email: ${email}
                    Numéro de Téléphone: ${telephone}
                `;

                emailjs.send("YOUR_SERVICE_ID", "YOUR_TEMPLATE_ID", {
                    nom_prenom: nomPrenom,
                    email: email,
                    telephone: telephone,
                    message: message
                }).then((response) => {
                    console.log('SUCCESS!', response.status, response.text);
                    nextQuestion();
                }, (err) => {
                    console.error('FAILED...', err);
                });
            }

            let currentQuestion = 1;
            const totalQuestions = 10;

            function showPage(page) {
                document.getElementById('page1').classList.add('hidden');
                document.getElementById('page2').classList.add('hidden');
                document.getElementById('page3').classList.add('hidden');
                document.getElementById(page).classList.remove('hidden');
            }

            function nextQuestion() {
                const currentDiv = document.querySelector(`[data-question="${currentQuestion}"]`);
                currentDiv.classList.add('hidden');
                currentQuestion++;
                if (currentQuestion <= totalQuestions) {
                    const nextDiv = document.querySelector(`[data-question="${currentQuestion}"]`);
                    nextDiv.classList.remove('hidden');
                } else {
                    showPage('page3');
                }
                updateProgressBar();
            }

            function previousQuestion() {
                if (currentQuestion > 1) {
                    const currentDiv = document.querySelector(`[data-question="${currentQuestion}"]`);
                    currentDiv.classList.add('hidden');
                    currentQuestion--;
                    const previousDiv = document.querySelector(`[data-question="${currentQuestion}"]`);
                    previousDiv.classList.remove('hidden');
                } else {
                    showPage('page1');
                }
                updateProgressBar();
            }

            function updateProgressBar() {
                const progress = (currentQuestion / totalQuestions) * 100;
                document.getElementById('progress').style.width = `${progress}%`;
            }

            function validateName() {
                const nameInput = document.getElementById('nom_prenom');
                const obligatoryMessage = document.getElementById('name-obligatory');

                if (/[a-z]/i.test(nameInput.value)) {
                    obligatoryMessage.classList.add('valid');
                } else {
                    obligatoryMessage.classList.remove('valid');
                }
            }

            function validateEmail() {
                const emailInput = document.getElementById('email');
                const nextButton = document.getElementById('email-next-button');
                const obligatoryMessage = document.getElementById('email-obligatory');

                if (emailInput.value.includes('@')) {
                    nextButton.disabled = false;
                    obligatoryMessage.classList.add('valid');
                } else {
                    nextButton.disabled = true;
                    obligatoryMessage.classList.remove('valid');
                }
            }

            function validateTelephone() {
                const phoneInput = document.getElementById('telephone');
                const nextButton = document.getElementById('telephone-next-button');
                const obligatoryMessage = document.getElementById('telephone-obligatory');

                if (phoneInput.value.replace(/\D/g, '').length >= 7) {
                    nextButton.disabled = false;
                    obligatoryMessage.classList.add('valid');
                } else {
                    nextButton.disabled = true;
                    obligatoryMessage.classList.remove('valid');
                }
            }
        </script>

        <div id="page1" class="max-w-xl mx-auto mt-10 bg-white bg-opacity-70 shadow-md rounded-lg overflow-hidden">
            <div class="p-6 text-center">
                <h1 class="text-2xl font-bold text-pink-600 mb-6">Bienvenue chez XL Clean Sofa</h1>
                <p class="text-gray-700 mb-4 text-base font-bold">OBTENEZ LE PRIX DE VOTRE DEVIS EN 5 MINUTES AVEC NOTRE APPLICATION.</p>
                <button class="bg-pink-500 text-white py-2 px-4 rounded-md hover:bg-pink-600" onclick="showPage('page2')">Démarrer maintenant</button>
                <p class="text-green-500 mt-4 font-bold">95 Devis Réalisés la semaine dernière</p>
            </div>
        </div>

        <div id="page2" class="max-w-xl mx-auto mt-10 bg-white bg-opacity-80 shadow-md rounded-lg overflow-hidden hidden">
            <div class="p-6">
                <h1 class="text-2xl font-bold text-center text-pink-600 mb-6">Votre Nettoyage Commence ici</h1>
                <div class="progress-bar">
                    <div id="progress" class="progress"></div>
                </div>
                <form id="devisForm" onsubmit="return false;">
                    <div class="form-group mb-4" data-question="1">
                        <label for="nom_prenom" class="block text-gray-700">1. Nom et Prénom :</label>
                        <input type="text" id="nom_prenom" class="w-full mt-1 p-2 border border-gray-300 rounded-md focus:ring-pink-500 focus:border-pink-500" placeholder="exemple : Alan Favre" required oninput="validateName()">
                        <p class="obligatory-message" id="name-obligatory"><i class="fas fa-exclamation-circle"></i> Champ obligatoire : veuillez compléter cette section avant de continuer.</p>
                        <div class="flex justify-between">
                            <button type="button" class="navigation-button next-button" onclick="nextQuestion()">Suivant</button>
                        </div>
                    </div>
                    <div class="form-group mb-4 hidden" data-question="2">
                        <label for="email" class="block text-gray-700">2. Adresse Mail :</label>
                        <input type="email" id="email" class="w-full mt-1 p-2 border border-gray-300 rounded-md focus:ring-pink-500 focus:border-pink-500" placeholder="exemple : alan.favre@exemple.com" required pattern="^[^\s@]+@[^\s@]+\.[^\s@]+$" title="Veuillez entrer une adresse email valide contenant @ et un domaine." oninput="validateEmail()">
                        <p class="obligatory-message" id="email-obligatory"><i class="fas fa-exclamation-circle"></i> Champ obligatoire : veuillez compléter cette section avant de continuer.</p>
                        <div class="flex justify-between">
                            <button type="button" class="navigation-button back-button" onclick="previousQuestion()">Retour</button>
                            <button type="button" class="navigation-button next-button" id="email-next-button" disabled onclick="nextQuestion()">Suivant</button>
                        </div>
                    </div>
                    <div class="form-group mb-4 hidden" data-question="3">
                        <label for="telephone" class="block text-gray-700">3. Numéro de Téléphone :</label>
                        <input type="tel" id="telephone" class="w-full mt-1 p-2 border border-gray-300 rounded-md focus:ring-pink-500 focus:border-pink-500" placeholder="exemple : 077 345 34 45" required pattern="^\d{10,15}$" title="Veuillez entrer un numéro de téléphone valide." oninput="validateTelephone()">
                        <p class="obligatory-message" id="telephone-obligatory"><i class="fas fa-exclamation-circle"></i> Champ obligatoire : veuillez compléter cette section avant de continuer.</p>
                        <div class="flex justify-between">
                            <button type="button" class="navigation-button back-button" onclick="previousQuestion()">Retour</button>
                            <button type="button" class="navigation-button next-button" id="telephone-next-button" disabled onclick="sendInitialData()">Suivant</button>
                        </div>
                    </div>
                    <!-- Questions 4 to 10 with placeholder numbers -->
                    <div class="form-group mb-4 hidden" data-question="4">
                        <label for="question4" class="block text-gray-700">4.</label>
                        <select id="question4" class="w-full mt-1 p-2 border border-gray-300 rounded-md focus:ring-pink-500 focus:border-pink-500" required>
                            <option value="" disabled selected>Choisissez…</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                        </select>
                        <div class="flex justify-between">
                            <button type="button" class="navigation-button back-button" onclick="previousQuestion()">Retour</button>
                            <button type="button" class="navigation-button next-button" onclick="nextQuestion()">Suivant</button>
                        </div>
                    </div>
                    <div class="form-group mb-4 hidden" data-question="5">
                        <label for="question5" class="block text-gray-700">5.</label>
                        <select id="question5" class="w-full mt-1 p-2 border border-gray-300 rounded-md focus:ring-pink-500 focus:border-pink-500" required>
                            <option value="" disabled selected>Choisissez…</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                        </select>
                        <div class="flex justify-between">
                            <button type="button" class="navigation-button back-button" onclick="previousQuestion()">Retour</button>
                            <button type="button" class="navigation-button next-button" onclick="nextQuestion()">Suivant</button>
                        </div>
                    </div>
                    <div class="form-group mb-4 hidden" data-question="6">
                        <label for="question6" class="block text-gray-700">6.</label>
                        <select id="question6" class="w-full mt-1 p-2 border border-gray-300 rounded-md focus:ring-pink-500 focus:border-pink-500" required>
                            <option value="" disabled selected>Choisissez…</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                        </select>
                        <div class="flex justify-between">
                            <button type="button" class="navigation-button back-button" onclick="previousQuestion()">Retour</button>
                            <button type="button" class="navigation-button next-button" onclick="nextQuestion()">Suivant</button>
                        </div>
                    </div>
                    <div class="form-group mb-4 hidden" data-question="7">
                        <label for="question7" class="block text-gray-700">7.</label>
                        <select id="question7" class="w-full mt-1 p-2 border border-gray-300 rounded-md focus:ring-pink-500 focus:border-pink-500" required>
                            <option value="" disabled selected>Choisissez…</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                        </select>
                        <div class="flex justify-between">
                            <button type="button" class="navigation-button back-button" onclick="previousQuestion()">Retour</button>
                            <button type="button" class="navigation-button next-button" onclick="nextQuestion()">Suivant</button>
                        </div>
                    </div>
                    <div class="form-group mb-4 hidden" data-question="8">
                        <label for="question8" class="block text-gray-700">8.</label>
                        <select id="question8" class="w-full mt-1 p-2 border border-gray-300 rounded-md focus:ring-pink-500 focus:border-pink-500" required>
                            <option value="" disabled selected>Choisissez…</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                        </select>
                        <div class="flex justify-between">
                            <button type="button" class="navigation-button back-button" onclick="previousQuestion()">Retour</button>
                            <button type="button" class="navigation-button next-button" onclick="nextQuestion()">Suivant</button>
                        </div>
                    </div>
                    <div class="form-group mb-4 hidden" data-question="9">
                        <label for="question9" class="block text-gray-700">9.</label>
                        <select id="question9" class="w-full mt-1 p-2 border border-gray-300 rounded-md focus:ring-pink-500 focus:border-pink-500" required>
                            <option value="" disabled selected>Choisissez…</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                        </select>
                        <div class="flex justify-between">
                            <button type="button" class="navigation-button back-button" onclick="previousQuestion()">Retour</button>
                            <button type="button" class="navigation-button next-button" onclick="nextQuestion()">Suivant</button>
                        </div>
                    </div>
                    <div class="form-group mb-4 hidden" data-question="10">
                        <label for="question10" class="block text-gray-700">10.</label>
                        <select id="question10" class="w-full mt-1 p-2 border border-gray-300 rounded-md focus:ring-pink-500 focus:border-pink-500" required>
                            <option value="" disabled selected>Choisissez…</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                        </select>
                        <div class="flex justify-between">
                            <button type="button" class="navigation-button back-button" onclick="previousQuestion()">Retour</button>
                            <button type="button" class="navigation-button next-button" onclick="nextQuestion()">Suivant</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>

        <div id="page3" class="max-w-xl mx-auto mt-10 bg-white shadow-md rounded-lg overflow-hidden hidden">
            <div class="p-6 text-center">
                <h1 class="text-2xl font-bold text-pink-600 mb-6">Votre Nettoyage Pour Seulement <span class="discounted-price" id="originalCost"></span> CHF</h1>
                <p class="discounted-price text-2xl mb-4"><span id="discountedPrice"></span> CHF</p>
                <p id="discount-message" class="promotion-message hidden">Rabais de 10% sur nos offres de janvier !</p>
                <p class="text-gray-700 mb-6">Merci de nous avoir choisi, XL Clean Sofa vous remercie pour votre fidélité.</p>

                <!-- Champ de saisie pour le code promo -->
                <div class="promo-code-section mb-4">
                    <input type="text" id="promo-code" placeholder="Code Promo" class="promo-input">
                    <button id="apply-promo" class="hidden bg-green-500 text-white py-2 px-4 rounded-md hover:bg-green-600">Appliquer</button>
                </div>

                <!-- Message de notification pour le code promo -->
                <div id="promo-notification" class="notification"></div>

                <!-- Boutons et liens -->
                <button class="bg-green-500 text-white py-2 px-4 mb-4 rounded-md hover:bg-green-600" onclick="window.location.href='https://calendly.com/ljdemenagement'">Organiser une visioconférence</button>
                <div class="mb-4">
                    <button class="bg-blue-500 text-white py-2 px-4 rounded-md hover:bg-blue-600" onclick="window.location.href='https://ljdemenagement.com'">Site Web</button>
                </div>

                <!-- Icônes sociales -->
                <div class="social-icons">
                    <a href="https://www.facebook.com/share/19uEbazn1Q/" target="_blank">
                        <i class="fab fa-facebook-f"></i>
                    </a>
                    <a href="https://www.instagram.com/ljdemenagement01?igsh=ZjZtdTRqdmJsNXk=" target="_blank">
                        <i class="fab fa-instagram"></i>
                    </a>
                    <a href="https://www.tiktok.com/@lj.demenagement?_t=ZN-8tvKSX4GP4Q&_r=1" target="_blank">
                        <i class="fab fa-tiktok"></i>
                    </a>
                    <a href="https://youtube.com/@ljdemenagement?si=qsAm-QkHyJLUB_fL" target="_blank">
                        <i class="fab fa-youtube"></i>
                    </a>
                </div>
                <p>Votre avis compte ! <a href="https://g.co/kgs/Cug2Dpz" target="_blank" class="text-blue-500 hover:underline">Laissez un feedback sur Google.</a></p>
                <p id="additional-cost-message" class="text-red-500 mt-4 hidden">Vous avez choisi des options qui peuvent entraîner des coûts supplémentaires.</p>
            </div>
        </div>

        <div id="confirmation-message" class="notification hidden"></div>
        <div id="notification" class="notification hidden"></div>

        <script>
            function validateForm() {
                const email = document.getElementById('email').value;
                const telephone = document.getElementById('telephone').value;

                if (!email || !telephone) {
                    document.getElementById('error-message').style.display = 'block';
                    setTimeout(() => {
                        document.getElementById('error-message').style.display = 'none';
                    }, 3000);
                    return;
                }

                const cost = calculateCost();
                saveForm(cost);
                checkAdditionalCost();
            }

            function calculateCost() {
                // Add logic to calculate the cost for sofa cleaning
                // This is a placeholder function
                return 100; // Example cost
            }

            function saveForm(cost) {
                const formDetails = {
                    Nom_prenom: document.getElementById('nom_prenom').value,
                    Email: document.getElementById('email').value,
                    Telephone: document.getElementById('telephone').value,
                    Estimated_cost: cost
                };

                const message = `
                    Madame, Monsieur, 

                    Nous vous remercions d'avoir utilisé notre application de devis instantané chez XL Clean Sofa. Voici votre devis estimé :

                    Nom et Prénom: ${formDetails.Nom_prenom}
                    Email: ${formDetails.Email}
                    Téléphone: ${formDetails.Telephone}
                    Coût Estimé: ${formDetails.Estimated_cost} CHF

                    Merci de nous faire confiance pour le nettoyage de votre canapé. Nous espérons avoir bientôt le plaisir de vous servir.

                    Cordialement,

                    L'équipe XL Clean Sofa
                `;

                emailjs.send("YOUR_SERVICE_ID", "YOUR_TEMPLATE_ID", {
                    to_email: formDetails.Email,
                    from_name: "XL Clean Sofa",
                    reply_to: formDetails.Email,
                    subject: "Demande de devis de XL Clean Sofa",
                    message: message
                }).then((response) => {
                    console.log('SUCCESS!', response.status, response.text);
                    showConfirmationMessage();
                    showPage('page3');
                }, (err) => {
                    console.error('FAILED...', err);
                    showNotification("Échec de l'envoi du formulaire.", 'error');
                });
            }
        </script>
    </div>
</body>
</html>