<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>L&J Déménagement</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #1a1a1a; /* Fond sombre */
            font-family: 'Roboto', sans-serif; /* Police moderne */
        }
        h1 {
            color: #ff69b4; /* Rose */
        }
        .progress-bar {
            width: 100%;
            height: 8px;
            background-color: #e5e7eb;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .progress {
            height: 8px;
            background-color: #ff69b4; /* Rose */
            width: 0%;
            border-radius: 5px;
            transition: width 0.4s ease;
        }
        .navigation-button {
            display: inline-block;
            margin: 5px;
            padding: 12px 24px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
            background-color: #ff69b4; /* Rose */
            color: white;
            font-weight: bold;
        }
        .back-button {
            background-color: #a0aec0;
            color: white;
        }
        .content-container {
            position: relative;
            z-index: 1;
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        input[type="text"], input[type="email"], input[type="tel"], select {
            width: 100%;
            padding: 12px;
            border: 2px solid #ccc;
            border-radius: 4px;
            margin-top: 8px;
            font-size: 1rem;
        }
        input:focus {
            border-color: #ff69b4; /* Rose */
        }
        .error-message {
            color: red;
            margin-top: 10px;
            font-weight: bold;
        }
        .notification {
            display: none;
            font-weight: bold;
            text-align: center;
        }
        .notification.success {
            color: #28a745;
        }
        .notification.error {
            color: #D32F2F;
        }
        .whatsapp-button {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: #25D366;
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: background-color 0.3s;
        }
        .whatsapp-button:hover {
            background-color: #128C7E;
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            emailjs.init("es5i8pk88qOLfaaBj");

            // Add WhatsApp button
            const whatsappButton = document.createElement('a');
            whatsappButton.href = "https://api.whatsapp.com/send?phone=41774786342";
            whatsappButton.target = "_blank";
            whatsappButton.innerHTML = '<button class="whatsapp-button"><i class="fab fa-whatsapp"></i></button>';
            document.body.appendChild(whatsappButton);
        });

        let currentGroup = 1;
        const totalGroups = 8;

        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(page => page.classList.add('hidden'));
            document.getElementById(pageId).classList.remove('hidden');
        }

        function nextGroup() {
            if (currentGroup < totalGroups) {
                document.getElementById(`group${currentGroup}`).classList.add('hidden');
                currentGroup++;
                document.getElementById(`group${currentGroup}`).classList.remove('hidden');
                updateProgressBar();
                if (currentGroup === 4) { // Envoi à EmailJS après la question 3
                    sendPartialData();
                }
            }
        }

        function previousGroup() {
            if (currentGroup > 1) {
                document.getElementById(`group${currentGroup}`).classList.add('hidden');
                currentGroup--;
                document.getElementById(`group${currentGroup}`).classList.remove('hidden');
                updateProgressBar();
            }
        }

        function updateProgressBar() {
            const progress = (currentGroup / totalGroups) * 100;
            document.getElementById('progress').style.width = `${progress}%`;
        }

        function validateForm() {
            const nomPrenom = document.getElementById('nom_prenom').value;
            const email = document.getElementById('email').value;
            const telephone = document.getElementById('telephone').value;

            const nomPrenomValid = nomPrenom.length >= 3;
            const telephoneValid = telephone.length >= 9;
            const emailValid = email.includes('@');

            if (!nomPrenomValid || !telephoneValid || !emailValid) {
                showNotification("Veuillez vérifier vos informations.", 'error');
                return false;
            }

            const cost = calculateCost();
            saveForm(cost);
            checkAdditionalCost();
        }

        function sendPartialData() {
            const formDetails = {
                Nom_prenom: document.getElementById('nom_prenom').value,
                Email: document.getElementById('email').value,
                Telephone: document.getElementById('telephone').value
            };

            emailjs.send("service_wd4pvu4", "template_e3f3f4p", {
                to_email: formDetails.Email,
                from_name: "L&J Déménagement",
                subject: "Demande de devis de L&J Déménagement",
                message: `Données partielles :\nNom et Prénom: ${formDetails.Nom_prenom}\nEmail: ${formDetails.Email}\nTéléphone: ${formDetails.Telephone}`
            }).then((response) => {
                console.log('SUCCESS!', response.status, response.text);
            }, (err) => {
                console.error('FAILED...', err);
                showNotification("Échec de l'envoi du formulaire.", 'error');
            });
        }

        function calculateCost() {
            let cost = 0;

            const pieces = document.getElementById('pieces').value;
            const nettoyage = document.getElementById('nettoyage').value;
            const distance = document.getElementById('distance').value;
            const cartons = document.getElementById('cartons').value;
            const lit_adulte = document.getElementById('lit_adulte').value;
            const lit_enfant = document.getElementById('lit_enfant').value;
            const meubles = document.getElementById('meubles').value;
            const canape = document.getElementById('canape').value;
            const frigo = document.getElementById('frigo').value;

            const piecesCost = {
                studio: 450,
                une_piece: 600,
                deux_pieces: 800,
                trois_pieces: 1150,
                quatre_pieces: 1450,
                cinq_pieces: 1800,
                six_pieces: 2200,
                sept_pieces: 2450,
                huit_pieces: 2700,
                neuf_pieces: 3050,
                dix_pieces: 3400
            };

            cost += piecesCost[pieces] || 0;

            const nettoyageCosts = {
                '30_49': 200,
                '50_69': 350,
                '70_89': 500,
                '90_109': 650,
                '110_129': 800,
                '130_149': 1000,
                '150_169': 1350,
                '170_189': 1700,
                '190_209': 2050,
                'plus_210': 2400
            };
            cost += nettoyageCosts[nettoyage] || 0;

            const distanceCosts = {
                '0_9': 0,
                '10_29': 50,
                '30_49': 80,
                '50_69': 120,
                '70_89': 160,
                '90_109': 200,
                'plus_110': 300
            };
            cost += distanceCosts[distance] || 0;

            const cartonsCosts = {
                'formule_m': 49,
                'formule_l': 138,
                'formule_xl': 270
            };
            cost += cartonsCosts[cartons] || 0;

            const litAdulteCosts = {
                '0': 0,
                '1': 0,
                '2': 0,
                '3': 100,
                '4': 150,
                '5': 200,
                '6': 250,
                '7': 300,
                '8': 350,
                'plus_de_huit': 400
            };
            cost += litAdulteCosts[lit_adulte] || 0;

            const litEnfantCosts = {
                '0': 0,
                '1': 0,
                '2': 0,
                '3': 50,
                '4': 75,
                '5': 100,
                '6': 125,
                '7': 150,
                '8': 175,
                'plus_de_huit': 200
            };
            cost += litEnfantCosts[lit_enfant] || 0;

            const meubleCosts = {
                '0': 0,
                '1': 150,
                '2': 300,
                '3': 450,
                '4': 600,
                '5': 750,
                '6': 900,
                '7': 1050,
                '8': 1200,
                'plus_de_huit': 1350
            };
            cost += meubleCosts[meubles] || 0;

            const canapeCosts = {
                '0': -50,
                '1': 0,
                '2': 0,
                '3': 25,
                '4': 50,
                'autre': 0
            };
            cost += canapeCosts[canape] || 0;

            const frigoCosts = {
                '0': 0,
                '1': 0,
                '2': 25,
                '3': 50,
                '4': 75,
                '5': 100,
                '6': 125,
                '7': 150,
                '8': 200,
                'plus_de_huit': 400
            };
            cost += frigoCosts[frigo] || 0;

            // Affichage du coût
            document.getElementById('originalCost').innerText = `${cost.toFixed(2)} CHF`;
            document.getElementById('discountedPrice').innerText = `${cost.toFixed(2)} CHF`;

            return cost;
        }

        function saveForm(cost) {
            // Logique pour sauvegarder le formulaire...
        }

        function checkAdditionalCost() {
            // Logique pour vérifier les coûts supplémentaires...
        }

        function showNotification(message, type) {
            const notification = document.getElementById('notification');
            notification.className = `notification ${type}`;
            notification.innerText = message;
            notification.style.display = 'block';
            setTimeout(() => {
                notification.style.display = 'none';
            }, 3000);
        }
    </script>
</head>

<body>
    <div class="content-container max-w-xl mx-auto mt-10">
        <h1 class="text-2xl font-bold mb-6">Rapide, Simple et Transparent Avec L&J Déménagement</h1>
        
        <div class="progress-bar">
            <div id="progress" class="progress"></div>
        </div>
        
        <form id="devisForm" onsubmit="return false;">
            <!-- Page 1 -->
            <div id="page1" class="page">
                <div id="group1" class="question-group">
                    <div class="form-group">
                        <label for="nom_prenom">Nom et Prénom :</label>
                        <input type="text" id="nom_prenom" placeholder="Exemple : Alan Favre" required>
                    </div>
                    <div class="form-group">
                        <label for="email">Adresse Mail :</label>
                        <input type="email" id="email" placeholder="Exemple : alan.favre@exemple.com" required>
                    </div>
                    <div class="form-group">
                        <label for="telephone">Numéro de Téléphone :</label>
                        <input type="tel" id="telephone" placeholder="Exemple : 077 345 34 45" required>
                    </div>
                    <div class="text-center">
                        <button type="button" class="navigation-button next-button" onclick="nextGroup()">Suivant</button>
                    </div>
                </div>
            </div>

            <!-- Page 2 -->
            <div id="page2" class="page hidden">
                <div id="group2" class="question-group">
                    <div class="form-group">
                        <label for="adresse_actuelle">Votre Adresse Actuelle :</label>
                        <input type="text" id="adresse_actuelle" placeholder="Exemple : Av Louis 5, 1400 Yverdon" required>
                    </div>
                    <div class="form-group">
                        <label for="adresse_future">Adresse de Destination :</label>
                        <input type="text" id="adresse_future" placeholder="Exemple : Rue du Lac 8, 1003 Lausanne" required>
                    </div>
                    <div class="form-group">
                        <label for="statut">Votre Statut :</label>
                        <select id="statut" required>
                            <option value="" disabled selected>Choisissez…</option>
                            <option value="Particulier">Particulier</option>
                            <option value="Entreprise">Entreprise</option>
                            <option value="Autre">Autre</option>
                        </select>
                    </div>
                    <div class="text-center">
                        <button type="button" class="navigation-button back-button" onclick="previousGroup()">Retour</button>
                        <button type="button" class="navigation-button next-button" onclick="nextGroup()">Suivant</button>
                    </div>
                </div>
            </div>

            <!-- Page 3 -->
            <div id="page3" class="page hidden">
                <div id="group3" class="question-group">
                    <div class="form-group">
                        <label for="formule">Sélection de la Formule :</label>
                        <select id="formule" required>
                            <option value="" disabled selected>Choisissez…</option>
                            <option value="economique">Économique</option>
                            <option value="premium">Premium</option>
                            <option value="prestige">Prestige</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="objet">Type de Logement :</label>
                        <select id="objet" required>
                            <option value="" disabled selected>Choisissez…</option>
                            <option value="Appartement">Appartement</option>
                            <option value="Maison">Maison</option>
                            <option value="Locaux">Locaux</option>
                            <option value="Autre">Autre</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="pieces">Nombre de Pièces :</label>
                        <select id="pieces" required>
                            <option value="" disabled selected>Choisissez…</option>
                            <option value="studio">Studio</option>
                            <option value="une_piece">Une pièce</option>
                            <option value="deux_pieces">Deux pièces</option>
                            <option value="trois_pieces">Trois pièces</option>
                            <option value="quatre_pieces">Quatre pièces</option>
                            <option value="cinq_pieces">Cinq pièces</option>
                            <option value="six_pieces">Six pièces</option>
                            <option value="sept_pieces">Sept pièces</option>
                            <option value="huit_pieces">Huit pièces</option>
                            <option value="neuf_pieces">Neuf pièces</option>
                            <option value="dix_pieces">Dix pièces</option>
                        </select>
                    </div>
                    <div class="text-center">
                        <button type="button" class="navigation-button back-button" onclick="previousGroup()">Retour</button>
                        <button type="button" class="navigation-button next-button" onclick="nextGroup()">Suivant</button>
                    </div>
                </div>
            </div>

            <!-- Page 4 -->
            <div id="page4" class="page hidden">
                <div id="group4" class="question-group">
                    <div class="form-group">
                        <label for="nettoyage">Service de Nettoyage :</label>
                        <select id="nettoyage" required>
                            <option value="" disabled selected>Choisissez…</option>
                            <option value="0">Pas de nettoyage</option>
                            <option value="30_49">30 m² à 49 m²</option>
                            <option value="50_69">50 m² à 69 m²</option>
                            <option value="70_89">70 m² à 89 m²</option>
                            <option value="90_109">90 m² à 109 m²</option>
                            <option value="110_129">110 m² à 129 m²</option>
                            <option value="130_149">130 m² à 149 m²</option>
                            <option value="150_169">150 m² à 169 m²</option>
                            <option value="170_189">170 m² à 189 m²</option>
                            <option value="190_209">190 m² à 209 m²</option>
                            <option value="plus_210">Plus de 230m²</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="distance">Distance du Déménagement :</label>
                        <select id="distance" required>
                            <option value="" disabled selected>Choisissez…</option>
                            <option value="0_9">0-9 km</option>
                            <option value="10_29">10-29 km</option>
                            <option value="30_49">30-49 km</option>
                            <option value="50_69">50-69 km</option>
                            <option value="70_89">70-89 km</option>
                            <option value="90_109">90-109 km</option>
                            <option value="plus_110">Plus de 110km</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="lit_adulte">Nombre de Lits Adultes :</label>
                        <select id="lit_adulte" required>
                            <option value="" disabled selected>Choisissez…</option>
                            <option value="0">0</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6">6</option>
                            <option value="7">7</option>
                            <option value="8">8</option>
                            <option value="plus_de_huit">Plus de huit</option>
                        </select>
                    </div>
                    <div class="text-center">
                        <button type="button" class="navigation-button back-button" onclick="previousGroup()">Retour</button>
                        <button type="button" class="navigation-button next-button" onclick="nextGroup()">Suivant</button>
                    </div>
                </div>
            </div>

            <!-- Page 5 -->
            <div id="page5" class="page hidden">
                <div id="group5" class="question-group">
                    <div class="form-group">
                        <label for="lit_enfant">Nombre de Lits Enfants :</label>
                        <select id="lit_enfant" required>
                            <option value="" disabled selected>Choisissez…</option>
                            <option value="0">0</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6">6</option>
                            <option value="7">7</option>
                            <option value="8">8</option>
                            <option value="plus_de_huit">Plus de huit</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="meubles">Nombre de Meubles :</label>
                        <select id="meubles" required>
                            <option value="" disabled selected>Choisissez…</option>
                            <option value="0">0</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6">6</option>
                            <option value="7">7</option>
                            <option value="8">8</option>
                            <option value="plus_de_huit">Plus de huit</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="canape">Type de Canapés :</label>
                        <select id="canape" required>
                            <option value="" disabled selected>Choisissez…</option>
                            <option value="0">Pas de canapés</option>
                            <option value="1">Canapé droit, trois places ou moins</option>
                            <option value="2">Canapé droit, plus de trois places</option>
                            <option value="3">Canapé d'angle</option>
                            <option value="4">Set de canapés 3+2+1</option>
                            <option value="autre">Autre</option>
                        </select>
                    </div>
                    <div class="text-center">
                        <button type="button" class="navigation-button back-button" onclick="previousGroup()">Retour</button>
                        <button type="button" class="navigation-button next-button" onclick="nextGroup()">Suivant</button>
                    </div>
                </div>
            </div>

            <!-- Page 6 -->
            <div id="page6" class="page hidden">
                <div id="group6" class="question-group">
                    <div class="form-group">
                        <label for="frigo">Nombre de Réfrigérateurs :</label>
                        <select id="frigo" required>
                            <option value="" disabled selected>Choisissez…</option>
                            <option value="0">0</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6">6</option>
                            <option value="7">7</option>
                            <option value="8">8</option>
                            <option value="plus_de_huit">Plus de huit</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="balcon">Présence d'un Balcon ou Terrasse :</label>
                        <select id="balcon" required>
                            <option value="" disabled selected>Choisissez…</option>
                            <option value="non">Non</option>
                            <option value="balcon">Oui, balcon</option>
                            <option value="terrasse">Oui, terrasse</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="cave">Présence d'une Cave :</label>
                        <select id="cave" required>
                            <option value="" disabled selected>Choisissez…</option>
                            <option value="non">Non</option>
                            <option value="oui">Oui</option>
                        </select>
                    </div>
                    <div class="text-center">
                        <button type="button" class="navigation-button back-button" onclick="previousGroup()">Retour</button>
                        <button type="button" class="navigation-button next-button" onclick="nextGroup()">Suivant</button>
                    </div>
                </div>
            </div>

            <!-- Page 7 -->
            <div id="page7" class="page hidden">
                <div id="group7" class="question-group">
                    <div class="form-group">
                        <label for="acces">Conditions d'Accès au Bâtiment :</label>
                        <select id="acces" required>
                            <option value="" disabled selected>Choisissez…</option>
                            <option value="facile">Facile</option>
                            <option value="difficile">Difficile</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="ascenseur">Ascenseur Disponible :</label>
                        <select id="ascenseur" required>
                            <option value="" disabled selected>Choisissez…</option>
                            <option value="rez_de_chaussee">Rez-de-chaussée</option>
                            <option value="deux_adresses">Oui aux deux adresses</option>
                            <option value="une_adresse">Oui à une seule adresse</option>
                            <option value="non">Non</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="monte_charge">Monte-Meuble Nécessaire :</label>
                        <select id="monte_charge" required>
                            <option value="" disabled selected>Choisissez…</option>
                            <option value="non">Non</option>
                            <option value="oui">Oui</option>
                        </select>
                    </div>
                    <div class="text-center">
                        <button type="button" class="navigation-button back-button" onclick="previousGroup()">Retour</button>
                        <button type="button" class="navigation-button next-button" onclick="nextGroup()">Suivant</button>
                    </div>
                </div>
            </div>

            <!-- Page 8 -->
            <div id="page8" class="page hidden">
                <div id="group8" class="question-group">
                    <div class="form-group">
                        <label for="cartons">Formule Cartons :</label>
                        <select id="cartons" required>
                            <option value="" disabled selected>Choisissez…</option>
                            <option value="non">Non</option>
                            <option value="formule_m">Formule M</option>
                            <option value="formule_l">Formule L</option>
                            <option value="formule_xl">Formule XL</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="commentaires">Commentaires :</label>
                        <input type="text" id="commentaires" placeholder="Informations supplémentaires">
                    </div>
                    <div class="text-center">
                        <button type="button" class="navigation-button back-button" onclick="previousGroup()">Retour</button>
                        <button type="button" class="navigation-button" onclick="validateForm()">Connaitre le coût de mon déménagement</button>
                    </div>
                </div>
            </div>
        </form>
        
        <!-- Affichage du coût -->
        <div id="costDisplay" class="hidden">
            <h2 class="text-2xl font-bold">Coût Estimé :</h2>
            <p id="originalCost" class="text-xl"></p>
            <p id="discountedPrice" class="text-xl"></p>
        </div>
        
        <div class="error-message hidden" id="error-message">Veuillez remplir tous les champs requis.</div>
        <div class="notification hidden" id="notification"></div>
    </div>
</body>
</html>